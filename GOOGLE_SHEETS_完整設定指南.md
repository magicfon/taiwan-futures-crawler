# 🌐 Google Sheets 完整設定指南

## 🎯 為什麼選擇Google Sheets？

✅ **電腦關機也能存取** - 完全雲端化  
✅ **任何裝置隨時查看** - 手機、平板、電腦  
✅ **即時自動更新** - 每日09:00自動同步  
✅ **內建圖表分析** - 直接製作專業圖表  
✅ **分享協作功能** - 輕鬆分享給他人  
✅ **完全免費使用** - Google免費額度充足  

## 📋 設定步驟（5分鐘完成）

### 步驟1: 建立Google Cloud專案
1. 前往 [Google Cloud Console](https://console.cloud.google.com/)
2. 點擊右上角「建立專案」
3. 專案名稱輸入：`台期所資料分析`
4. 點擊「建立」並等待專案建立完成

### 步驟2: 啟用必要的API
1. 在左側選單中點擊「API和服務」→「程式庫」
2. 搜尋並啟用以下API：
   - `Google Sheets API`（點擊「啟用」）
   - `Google Drive API`（點擊「啟用」）

### 步驟3: 建立服務帳號
1. 點擊「API和服務」→「憑證」
2. 點擊「建立憑證」→「服務帳號」
3. 服務帳號名稱：`sheets-automation`
4. 服務帳號ID會自動產生，直接點擊「建立並繼續」
5. 角色設定可以跳過，點擊「繼續」
6. 點擊「完成」

### 步驟4: 下載認證金鑰
1. 在憑證頁面找到剛建立的服務帳號
2. 點擊服務帳號Email地址
3. 切換到「金鑰」分頁
4. 點擊「新增金鑰」→「建立新金鑰」
5. 選擇「JSON」格式
6. 點擊「建立」，會自動下載JSON檔案

### 步驟5: 設定本地認證
1. 將下載的JSON檔案重新命名為：`google_sheets_credentials.json`
2. 將檔案放到專案的 `config/` 目錄下
3. 確保檔案路徑是：`config/google_sheets_credentials.json`

### 步驟6: 測試連接
在專案目錄執行：
```bash
python google_sheets_manager.py
```

如果看到「✅ Google Sheets連接成功！」就表示設定完成了！

## 🚀 GitHub Actions 自動化設定

### 1. 設定GitHub Secrets
1. 打開你的GitHub倉庫頁面
2. 點擊「Settings」→「Secrets and variables」→「Actions」
3. 點擊「New repository secret」
4. Name: `GOOGLE_SHEETS_CREDENTIALS`
5. Secret: 把整個JSON檔案內容貼上（包含大括號{}）
6. 點擊「Add secret」

### 2. 測試自動化
1. GitHub Actions會在每日09:00自動執行
2. 或者你可以手動觸發：「Actions」→「每日台期所資料爬取」→「Run workflow」

## 📱 使用方式

### 手機存取
1. 下載「Google試算表」APP
2. 登入你的Google帳號
3. 找到「台期所資料分析」試算表
4. 隨時查看最新資料和圖表

### 電腦存取
1. 打開任何瀏覽器
2. 訪問試算表網址（程式執行後會顯示）
3. 書籤收藏，一鍵存取

### 試算表結構
- **最新30天資料** - 完整的原始交易資料
- **每日摘要** - 三大法人淨部位統計
- **三大法人趨勢** - 含7日移動平均線
- **系統資訊** - 更新狀態和使用說明

## 🎨 進階功能

### 自製圖表
1. 選取資料範圍
2. 點擊「插入」→「圖表」
3. 選擇圖表類型（線圖、柱狀圖等）
4. 可製作專業的分析圖表

### 分享功能
1. 點擊右上角「分享」按鈕
2. 設定分享權限（檢視/編輯）
3. 複製連結分享給其他人

### 手機通知
1. 在Google試算表APP中
2. 點擊「...」→「通知規則」
3. 設定資料變更時發送通知

## 🔧 常見問題

### Q: 認證檔案放在哪裡？
A: 確保檔案在 `config/google_sheets_credentials.json`

### Q: 為什麼連接失敗？
A: 檢查是否已啟用Google Sheets API和Google Drive API

### Q: 手機看不到資料？
A: 確認已登入相同的Google帳號，試算表會自動出現在APP中

### Q: 可以同時給多人使用嗎？
A: 可以！使用分享功能邀請其他人檢視或編輯

## 🎉 完成後的體驗

設定完成後，你將擁有：

- 🌍 **全球存取** - 任何地方、任何時間都能查看台期所資料
- 📊 **即時分析** - 資料每日自動更新，無需手動操作
- 📱 **行動便利** - 手機APP隨時掌握市場動態
- 🤝 **團隊協作** - 輕鬆分享給投資夥伴或客戶
- 🔒 **資料安全** - Google雲端保護，永不遺失

**真正實現「電腦關機，資料不斷線」的投資分析體驗！**

---

## 💡 小提示

- 第一次設定需要5-10分鐘，之後就完全自動化了
- 建議將試算表網址加入手機書籤
- 可以在試算表中直接添加註解和分析
- Google Sheets支援超過100萬行資料，完全夠用

有問題歡迎隨時詢問！ 🙋‍♂️ 